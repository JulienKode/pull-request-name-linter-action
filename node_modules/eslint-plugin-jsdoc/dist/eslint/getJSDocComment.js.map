{"version":3,"sources":["../../src/eslint/getJSDocComment.js"],"names":["isCommentToken","token","type","getDecorator","sourceCode","tokenBefore","getTokenBefore","includeComments","value","looksLikeExport","astNode","getTSFunctionComment","parent","grandparent","greatGrandparent","greatGreatGrandparent","getReducedASTNode","node","includes","getCommentsBefore","length","test","getJSDocComment","settings","findJSDocComment","minLines","maxLines","currentNode","decorator","charAt","loc","start","line","end","reducedNode"],"mappings":"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","sourcesContent":["/**\n * Obtained originally from {@link https://github.com/eslint/eslint/blob/master/lib/util/source-code.js#L313}\n *\n * @license MIT\n */\n\n/**\n * Checks if the given token is a comment token or not.\n *\n * @param {Token} token - The token to check.\n * @returns {boolean} `true` if the token is a comment token.\n */\nconst isCommentToken = (token) => {\n  return token.type === 'Line' || token.type === 'Block' || token.type === 'Shebang';\n};\n\nconst getDecorator = (token, sourceCode) => {\n  if (token && token.type === 'Identifier') {\n    const tokenBefore = sourceCode.getTokenBefore(token, {includeComments: true});\n    if (tokenBefore && tokenBefore.type === 'Punctuator' && tokenBefore.value === '@') {\n      return tokenBefore;\n    }\n  }\n\n  return false;\n};\n\n/**\n * Check to see if its a ES6 export declaration.\n *\n * @param {ASTNode} astNode An AST node.\n * @returns {boolean} whether the given node represents an export declaration.\n * @private\n */\nconst looksLikeExport = function (astNode) {\n  return astNode.type === 'ExportDefaultDeclaration' || astNode.type === 'ExportNamedDeclaration' ||\n    astNode.type === 'ExportAllDeclaration' || astNode.type === 'ExportSpecifier';\n};\n\nconst getTSFunctionComment = function (astNode) {\n  const {parent} = astNode;\n  const grandparent = parent.parent;\n  const greatGrandparent = grandparent.parent;\n  const greatGreatGrandparent = greatGrandparent && greatGrandparent.parent;\n\n  // istanbul ignore if\n  if (parent.type !== 'TSTypeAnnotation') {\n    return astNode;\n  }\n\n  switch (grandparent.type) {\n  case 'ClassProperty':\n  case 'TSDeclareFunction':\n  case 'TSMethodSignature':\n  case 'TSPropertySignature':\n    return grandparent;\n  case 'ArrowFunctionExpression':\n    // istanbul ignore else\n    if (\n      greatGrandparent.type === 'VariableDeclarator'\n\n    // && greatGreatGrandparent.parent.type === 'VariableDeclaration'\n    ) {\n      return greatGreatGrandparent.parent;\n    }\n\n    // istanbul ignore next\n    return astNode;\n  case 'FunctionExpression':\n    // istanbul ignore else\n    if (greatGrandparent.type === 'MethodDefinition') {\n      return greatGrandparent;\n    }\n\n  // Fallthrough\n  default:\n    // istanbul ignore if\n    if (grandparent.type !== 'Identifier') {\n      // istanbul ignore next\n      return astNode;\n    }\n  }\n\n  // istanbul ignore next\n  switch (greatGrandparent.type) {\n  case 'ArrowFunctionExpression':\n    // istanbul ignore else\n    if (\n      greatGreatGrandparent.type === 'VariableDeclarator' &&\n      greatGreatGrandparent.parent.type === 'VariableDeclaration'\n    ) {\n      return greatGreatGrandparent.parent;\n    }\n\n    // istanbul ignore next\n    return astNode;\n  case 'FunctionDeclaration':\n    return greatGrandparent;\n  case 'VariableDeclarator':\n    // istanbul ignore else\n    if (greatGreatGrandparent.type === 'VariableDeclaration') {\n      return greatGreatGrandparent;\n    }\n\n    // Fallthrough\n  default:\n    // istanbul ignore next\n    return astNode;\n  }\n};\n\n/* eslint-disable complexity */\n/**\n * Reduces the provided node to the appropriate node for evaluating JSDoc comment status.\n *\n * @param {ASTNode} node An AST node.\n * @param {SourceCode} sourceCode The ESLint SourceCode.\n * @returns {ASTNode} The AST node that can be evaluated for appropriate JSDoc comments.\n * @private\n */\nconst getReducedASTNode = function (node, sourceCode) {\n  let {parent} = node;\n\n  switch (node.type) {\n  case 'TSFunctionType':\n    return getTSFunctionComment(node);\n  case 'TSInterfaceDeclaration':\n  case 'TSTypeAliasDeclaration':\n  case 'TSEnumDeclaration':\n  case 'ClassDeclaration':\n  case 'FunctionDeclaration':\n    return looksLikeExport(parent) ? parent : node;\n\n  case 'ClassExpression':\n  case 'ObjectExpression':\n  case 'ArrowFunctionExpression':\n  case 'TSEmptyBodyFunctionExpression':\n  case 'FunctionExpression':\n    if (\n      !['CallExpression', 'OptionalCallExpression', 'NewExpression'].includes(parent.type)\n    ) {\n      while (\n        !sourceCode.getCommentsBefore(parent).length &&\n        !/Function/u.test(parent.type) &&\n        parent.type !== 'MethodDefinition' &&\n        parent.type !== 'Property'\n      ) {\n        parent = parent.parent;\n\n        if (!parent) {\n          break;\n        }\n      }\n\n      if (parent && parent.type !== 'FunctionDeclaration' && parent.type !== 'Program') {\n        return parent;\n      }\n    }\n\n    return node;\n\n  default:\n    return node;\n  }\n};\n\n/**\n * Retrieves the JSDoc comment for a given node.\n *\n * @param {SourceCode} sourceCode The ESLint SourceCode\n * @param {ASTNode} node The AST node to get the comment for.\n * @param {object} settings The settings in context\n * @returns {Token|null} The Block comment token containing the JSDoc comment\n *    for the given node or null if not found.\n * @public\n * @deprecated\n */\nconst getJSDocComment = function (sourceCode, node, settings) {\n  /**\n   * Checks for the presence of a JSDoc comment for the given node and returns it.\n   *\n   * @param {ASTNode} astNode The AST node to get the comment for.\n   * @returns {Token|null} The Block comment token containing the JSDoc comment\n   *    for the given node or null if not found.\n   * @private\n   */\n  const findJSDocComment = (astNode) => {\n    const {minLines, maxLines} = settings;\n    let currentNode = astNode;\n    let tokenBefore = null;\n\n    while (currentNode) {\n      tokenBefore = sourceCode.getTokenBefore(currentNode, {includeComments: true});\n      const decorator = getDecorator(tokenBefore, sourceCode);\n      if (decorator) {\n        currentNode = decorator;\n        continue;\n      }\n      if (!tokenBefore || !isCommentToken(tokenBefore)) {\n        return null;\n      }\n      if (tokenBefore.type === 'Line') {\n        currentNode = tokenBefore;\n        continue;\n      }\n      break;\n    }\n\n    if (\n      tokenBefore.type === 'Block' &&\n      tokenBefore.value.charAt(0) === '*' &&\n      currentNode.loc.start.line - tokenBefore.loc.end.line >= minLines &&\n      currentNode.loc.start.line - tokenBefore.loc.end.line <= maxLines\n    ) {\n      return tokenBefore;\n    }\n\n    return null;\n  };\n\n  const reducedNode = getReducedASTNode(node, sourceCode);\n  /* istanbul ignore next */\n  if (!reducedNode) {\n    return null;\n  }\n\n  return findJSDocComment(reducedNode);\n};\n\nexport {getReducedASTNode};\nexport default getJSDocComment;\n"],"file":"getJSDocComment.js"}